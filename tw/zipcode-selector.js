$cityData={},$distData={},$Gaia={},$Gaia.init_zipcode_selector=function(){$.ajax({url:"https://demeter.5fpro.com/tw/zipcode/cities.json",async:!1,success:function(t){$cityData=t}}),$.ajax({url:"https://demeter.5fpro.com/tw/zipcodes.json",async:!1,success:function(t){$distData=t}});var t=function(t){var e=null;return $distData.forEach(function(i){i.zipcode==t&&(e=i)}),e},e=function(t){var e=null;return $cityData.forEach(function(i){i.name==t&&(e=i)}),e},i=function(e){if(((e=e||$(this).val())+"").length>0){var i=t(e);i&&this.changeSelects(i)}else this.changeCitySelect()},c=function(t){this.changeCitySelect(t.city_name),this.changeDistSelect(t)},n=function(t){var e=this,i=this.citySelect;i.html("<option>"+this.citySelect.attr("placeholder")+"</option>"),$cityData.forEach(function(c){if(!e.is_exclude(c.name)){var n=c.name==t?" selected":"";i.append('<option value="'+c.name+'"'+n+">"+c.name+"</option>")}})},a=function(t){var i=this,c=this.distSelect;c.html("<option>"+c.attr("placeholder")+"</option>");var n=e(t.city_name);n&&$.get(n.zipcodes_endpoint,null,function(e){e.forEach(function(e){if(!i.is_exclude(e.zipcode)&&!i.is_exclude(e.name)){var n=e.zipcode==t.zipcode?" selected":"";c.append('<option value="'+e.name+'"'+n+">"+e.zipcode+" "+e.name+"</option>")}})})},o=function(t){var i=this,c=this.distSelect;c.html("<option>"+this.distSelect.attr("placeholder")+"</option>");var n=e(t);$.get(n.zipcodes_endpoint,null,function(t){t.forEach(function(t){i.is_exclude(t.zipcode)||i.is_exclude(t.name)||c.append('<option value="'+t.zipcode+'">'+t.zipcode+" "+t.name+"</option>")})})},s=function(t){return this.exclude.includes(t)};$(".js-gaia-zipcode").each(function(){var t=this;t.citySelect=$($(t).data("city")),t.distSelect=$($(t).data("dist")),t.applyZipcode=i,t.changeSelects=c,t.changeCitySelect=n,t.changeDistSelect=a,t.initDistSelect=o,t.exclude=($(t).data("exclude")||"").split(","),t.is_exclude=s;var e=0;$(t).on("keypress",function(){clearTimeout(e),e=setTimeout(function(){t.applyZipcode()},500)}),t.citySelect.on("change",function(){t.initDistSelect($(this).val())}),t.distSelect.on("change",function(){$(t).val($(this).val())}),$(t).trigger("keypress")})},$(function(){$Gaia.init_zipcode_selector()});